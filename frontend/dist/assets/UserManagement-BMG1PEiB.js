import{A as C,a as b}from"./index-Byhz0bWx.js";import{d as p,f as h,g as z,l as S,m as U,B as x,j as B,n as I}from"./naive-ui-DOxxWvKY.js";import{k as A,r as i,e as M,c as V,o as D,H as f,I as v,W as t,O as l,P as s,K as L,j as g,N as P,M as y,m as T}from"./vue-vendor-CMZ7xYHN.js";const j={class:"card-header"},q=A({__name:"UserManagement",setup(K){const d=i([]),n=i(!1),r=i(null),o=i(""),u=M({page:1,pageSize:10,showSizePicker:!1}),_=[{title:"ID",key:"id",sorter:(e,a)=>e.id-a.id,width:80},{title:"用户名",key:"username",ellipsis:{tooltip:!0}},{title:"邮箱",key:"email",ellipsis:{tooltip:!0},render(e){return e.email||"—"}},{title:"权限",key:"is_admin",align:"center",render(e){return T(I,{type:e.is_admin?"success":"default",bordered:!1,size:"small"},{default:()=>e.is_admin?"管理员":"普通用户"})}}],k=V(()=>{if(!o.value.trim())return d.value;const e=o.value.trim().toLowerCase();return d.value.filter(a=>a.username.toLowerCase().includes(e)||a.email&&a.email.toLowerCase().includes(e))}),N=e=>e.id,c=async()=>{n.value=!0,r.value=null;try{d.value=await C.listUsers()}catch(e){r.value=e instanceof Error?e.message:"获取用户数据失败"}finally{n.value=!1}},w=()=>{u.page=1};return D(c),(e,a)=>(v(),f(s(B),{bordered:!1,class:"admin-card"},{header:t(()=>[y("div",j,[a[3]||(a[3]=y("span",{class:"card-title"},"用户管理",-1)),l(s(p),{size:12},{default:t(()=>[l(s(U),{value:o.value,"onUpdate:value":[a[0]||(a[0]=m=>o.value=m),w],clearable:"",round:"",placeholder:"搜索用户名或邮箱",class:"search-input"},null,8,["value"]),l(s(x),{quaternary:"",size:"small",onClick:c,loading:n.value},{default:t(()=>[...a[2]||(a[2]=[g(" 刷新 ",-1)])]),_:1},8,["loading"])]),_:1})])]),default:t(()=>[l(s(p),{vertical:"",size:"large"},{default:t(()=>[r.value?(v(),f(s(h),{key:0,type:"error",closable:"",onClose:a[1]||(a[1]=m=>r.value=null)},{default:t(()=>[g(P(r.value),1)]),_:1})):L("",!0),l(s(z),{show:n.value},{default:t(()=>[l(s(S),{columns:_,data:k.value,bordered:!1,pagination:u,"row-key":N,class:"user-table"},null,8,["data","pagination"])]),_:1},8,["show"])]),_:1})]),_:1}))}}),W=b(q,[["__scopeId","data-v-678a4b7d"]]);export{W as default};
